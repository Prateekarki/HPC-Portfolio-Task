#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <GL/glut.h>
#include <GL/gl.h>
#include <malloc.h>
#include <signal.h>
#include <pthread.h>

/******************************************************************************
  Displays two grey scale images. On the left is an image that has come from an 
  image processing pipeline, just after colour thresholding. On the right is 
  the result of applying an edge detection convolution operator to the left
  image. This program performs that convolution.
   
  Things to note:
    - A single unsigned char stores a pixel intensity value. 0 is black, 256 is
      white.
    - The colour mode used is GL_LUMINANCE. This uses a single number to 
      represent a pixel's intensity. In this case we want 256 shades of grey,
      which is best stored in eight bits, so GL_UNSIGNED_BYTE is specified as 
      the pixel data type.
    
  To compile adapt the code below wo match your filenames:  
     gcc -o ip_coursework_069_mt ip_coursework_069_mt.c -lglut -lGL -lm -pthread
    ./ip_coursework_069_mt
   
  Dr Kevan Buckley, University of Wolverhampton, 2018
******************************************************************************/
#define width 100 
#define height 72

  unsigned char image[], results[width * height];
//dataset
  unsigned char image[] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,
  	255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,255,0,0,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,0,255,255,255,0,0,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,
  	255,255,255,0,255,255,0,255,255,255,255,0,255,255,0,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,0,255,0,255,255,0,255,0,
  	255,255,0,255,0,255,255,255,255,0,255,255,0,0,255,255,255,255,0,
  	0,0,255,0,255,255,255,255,255,255,255,255,255,255,0,255,255,0,0,
  	255,0,255,255,0,255,255,255,0,255,255,0,0,255,0,255,0,255,0,
  	0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,0,0,
  	255,255,0,255,0,0,255,0,255,0,0,0,0,0,0,255,255,0,0,
  	255,255,0,0,0,255,0,255,0,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,0,0,255,0,255,255,0,255,255,0,255,255,255,0,255,255,
  	255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,
  	255,255,0,255,255,0,255,0,0,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,0,255,255,255,0,255,255,255,255,255,
  	255,255,255,255,255,0,0,255,255,255,255,255,255,255,0,0,255,255,255,
  	255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,0,0,255,
  	0,255,255,0,255,0,0,255,255,0,0,255,255,255,0,255,0,0,255,
  	0,0,0,255,0,255,255,255,0,255,255,255,255,255,255,255,0,255,255,
  	255,0,255,255,255,255,255,0,255,255,255,255,0,255,0,255,0,0,255,
  	255,0,0,0,0,0,0,0,255,0,0,0,255,0,255,0,255,255,255,
  	255,255,255,255,255,0,255,0,255,255,0,0,255,255,255,255,255,0,255,
  	0,0,0,255,0,0,0,255,0,0,0,255,255,0,255,255,255,255,0,
  	0,255,0,0,0,255,0,0,255,0,0,255,0,0,255,255,255,255,0,
  	0,255,0,0,0,255,0,255,0,0,0,255,0,0,255,255,0,0,0,
  	0,255,0,255,255,255,255,0,0,255,255,0,0,255,0,0,255,0,0,
  	255,0,255,255,255,255,255,255,255,255,255,0,0,255,255,0,255,255,255,
  	255,255,255,0,0,255,255,255,255,255,255,0,255,255,0,255,255,0,255,
  	255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,0,255,0,0,255,0,0,0,255,255,255,0,255,0,
  	255,255,255,0,255,0,255,255,255,255,0,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,
  	255,255,0,0,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,
  	0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,
  	0,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,0,255,0,0,0,0,0,0,0,255,255,
  	255,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,0,
  	0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,255,255,0,
  	0,0,0,255,255,255,255,255,0,255,255,0,0,0,0,255,255,255,0,
  	0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,255,255,255,255,
  	255,255,255,0,0,0,0,255,255,255,255,255,255,0,0,0,0,0,0,
  	0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,255,255,255,255,
  	255,255,255,255,0,0,0,0,0,0,0,0,0,0,255,255,255,255,0,
  	0,0,255,255,255,0,0,0,0,255,255,255,0,0,255,255,0,0,0,
  	0,255,255,255,0,0,0,0,255,255,255,255,0,0,0,0,0,0,0,
  	0,0,255,255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,0,
  	0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0,0,
  	0,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,
  	255,255,255,255,0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,
  	255,255,0,0,0,0,255,255,255,0,0,0,0,255,255,255,0,0,0,
  	0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,255,255,
  	255,255,255,255,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,
  	0,0,0,0,0,0,255,255,255,255,255,255,255,255,0,0,0,0,0,
  	255,0,0,0,0,0,255,255,255,0,0,0,255,255,255,0,0,0,0,
  	0,0,0,0,0,255,255,0,0,0,0,255,255,255,0,0,0,0,255,
  	255,255,0,0,0,0,255,255,255,0,0,0,0,255,255,255,255,255,0,
  	0,0,0,255,255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,
  	255,255,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	0,0,0,0,255,255,255,0,0,0,0,255,255,255,0,0,0,255,255,
  	255,255,0,0,0,0,0,0,0,0,255,255,0,0,0,0,255,255,255,
  	0,0,0,0,255,255,255,0,0,0,0,255,255,255,0,0,0,0,255,
  	255,255,255,255,0,0,0,0,255,255,255,255,255,255,0,0,0,0,255,
  	255,255,255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,0,0,0,0,255,255,255,0,0,0,0,255,255,255,
  	0,0,0,255,255,255,255,0,0,0,0,255,0,0,0,255,255,0,0,
  	0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,255,255,255,255,
  	255,0,0,0,0,255,255,255,255,0,0,0,0,255,255,255,255,255,255,
  	0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,0,0,0,0,255,255,255,0,0,
  	0,0,255,255,255,0,0,0,255,255,255,255,0,0,0,0,255,0,0,
  	0,255,255,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,
  	0,255,255,255,255,255,0,0,0,0,255,255,255,255,0,0,0,0,255,
  	255,255,255,255,255,0,0,0,0,0,0,0,0,0,255,255,255,0,0,
  	0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,
  	255,255,255,0,0,0,0,255,255,255,0,0,0,255,255,255,255,255,0,
  	0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,
  	255,255,255,0,0,0,0,255,255,255,255,0,0,0,0,255,255,255,255,
  	0,0,0,0,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,
  	255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,0,0,0,0,255,255,255,0,0,0,0,255,255,255,0,0,0,255,
  	255,255,255,255,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,
  	0,0,0,0,0,0,255,255,0,0,0,0,255,255,255,0,0,0,0,
  	255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,0,0,0,0,
  	255,255,255,255,255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,0,0,0,0,255,255,0,0,0,0,0,255,255,
  	255,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,255,255,0,
  	0,0,0,255,255,255,255,0,0,0,0,255,255,0,0,0,0,0,255,
  	0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,255,
  	255,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,
  	0,0,255,255,255,255,0,0,0,255,255,255,255,255,255,0,0,0,0,
  	0,255,255,255,0,0,0,0,255,255,255,255,0,0,0,0,255,255,255,
  	0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,
  	0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,255,255,255,0,
  	0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,
  	0,0,0,0,0,0,0,255,255,255,255,0,0,0,255,255,255,255,255,
  	255,0,0,0,0,0,255,255,255,0,0,0,0,255,255,255,255,0,0,
  	0,0,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,0,0,
  	0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,
  	0,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,
  	255,255,255,255,255,255,0,0,0,0,0,255,255,255,255,0,0,0,255,
  	255,255,255,0,0,0,255,255,255,255,255,255,0,0,0,0,0,255,255,
  	255,255,255,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  	255,255,255,255,255,255,255,255,255,255,0,0,255,255,0,0,255,255,0,
  	255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  };
  typedef struct arguments_t {
  	int start;
  	int stride;
  } arguments_t;

  void *imgdetect(arguments_t *args){
  	detect_edges(image, results, args);

  }
  void detect_edges(unsigned char *in, unsigned char *out) {
  	int i;
  	int n_pixels = width * height;

  	for(i=0;i<n_pixels;i++) {
    int x, y; // the pixel of interest
    int b, d, f, h; // the pixels adjacent to x,y used for the calculation
    int r; // the result of calculate
    
    y = i / width;
    x = i - (width * y);

    if (x == 0 || y == 0 || x == width - 1 || y == height - 1) {
    	results[i] = 0;
    } else {
    	b = i + width;
    	d = i - 1;
    	f = i + 1;
    	h = i - width;

    	r = (in[i] * 4) + (in[b] * -1) + (in[d] * -1) + (in[f] * -1)
    	+ (in[h] * -1);

      if (r > 0) { // if the result is positive this is an edge pixel
      	out[i] = 255;
      } else {
      	out[i] = 0;
      }
  }
}
}
void tidy_and_exit() {
	exit(0);
}
void sigint_callback(int signal_number){
	printf("\nInterrupt from keyboard\n");
	tidy_and_exit();
}
static void display() {
	glClear(GL_COLOR_BUFFER_BIT);
	glRasterPos4i(-1, -1, 0, 1);
	glDrawPixels(width, height, GL_LUMINANCE, GL_UNSIGNED_BYTE, image);
	glRasterPos4i(0, -1, 0, 1);
	glDrawPixels(width, height, GL_LUMINANCE, GL_UNSIGNED_BYTE, results);
	glFlush();
}
static void key_pressed(unsigned char key, int x, int y) {
	switch(key){
    case 27: // escape
    tidy_and_exit();
    break;
    default: 
    //printf("\nPress escape to exit\n");
    break;
}
}
//time difference
int time_difference(struct timespec *start, struct timespec *finish,
	long long int *difference) {
	long long int ds =  finish->tv_sec - start->tv_sec; 
	long long int dn =  finish->tv_nsec - start->tv_nsec; 
	if(dn < 0 ) {
		ds--;
		dn += 1000000000; 
	} 
	*difference = ds * 1000000000 + dn;
	return !(*difference > 0);
}
int main(int argc, char **argv) {

	struct timespec start, finish;   
	long long int time_elapsed;
	clock_gettime(CLOCK_MONOTONIC, &start);
	signal(SIGINT, sigint_callback);
		//function call
	detect_edges(image, results);
		//pthread variables
	pthread_t thread_1, thread_2, thread_3, thread_4;

	arguments_t thread_1_arguments;
	thread_1_arguments.start = 0;
	thread_1_arguments.stride = 4;

	arguments_t thread_2_arguments;
	thread_2_arguments.start = 1;
	thread_2_arguments.stride = 4;

	arguments_t thread_3_arguments;
	thread_3_arguments.start = 2;
	thread_3_arguments.stride = 4;

	arguments_t thread_4_arguments;
	thread_4_arguments.start = 3;
	thread_4_arguments.stride = 4;
		//pthread created function passed to thread
	pthread_create(&thread_1, NULL, imgdetect, &thread_1_arguments);
	pthread_create(&thread_2, NULL, imgdetect, &thread_2_arguments);
	pthread_create(&thread_3, NULL, imgdetect, &thread_3_arguments);
	pthread_create(&thread_4, NULL, imgdetect, &thread_4_arguments);
		///thread joined
	pthread_join(thread_1, NULL);
	pthread_join(thread_2, NULL);
	pthread_join(thread_3, NULL);
	pthread_join(thread_4, NULL);

	clock_gettime(CLOCK_MONOTONIC, &finish);
	time_difference(&start, &finish, &time_elapsed);
	printf("Time elapsed was %lldns or %0.9lfs\n", time_elapsed,
		(time_elapsed/1.0e9)); 

	glutInit(&argc, argv);
	glutInitWindowSize(width * 2,height);
	glutInitDisplayMode(GLUT_SINGLE | GLUT_LUMINANCE);
	glutCreateWindow("6CS005 Image Progessing Courework");
	glutDisplayFunc(display);
	glutKeyboardFunc(key_pressed);
	glClearColor(0.0, 1.0, 0.0, 1.0); 
	glutMainLoop(); 

	tidy_and_exit();

	return 0;
}

